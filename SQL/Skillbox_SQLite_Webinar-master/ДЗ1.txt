1. Покажите  фамилию и имя клиентов из города Прага ?

SELECT ifnull(FirstName, 'UnknownCity') || ' ' || ifnull(LastName, 'UnkonownCity') as customers_Prague
  FROM customers
 WHERE City = 'Prague';

2. Покажите  фамилию и имя клиентов у которых имя начинается букву M ? Содержит символ "ch"?

SELECT ifnull(FirstName, 'UnknownCity') || ' ' || ifnull(LastName, 'UnkonownCity') as customers
  FROM customers
 WHERE FirstName like 'M%ch%'

3. Покажите название и размер музыкальных треков в Мегабайтах ?

SELECT 
       Name as Track_name,
       Bytes / 1048576 as Track_size_approximately
  FROM tracks

4. Покажите  фамилию и имя сотрудников кампании нанятых в 2002 году из города Калгари ?

SELECT 
       LastName || ' ' || FirstName as employees_hireDate_2002
  FROM employees
  WHERE strftime('%Y', HireDate) = '2002'

5. Покажите  фамилию и имя сотрудников кампании нанятых в возрасте 40 лет и выше?

SELECT LastName || ' ' || FirstName AS employees_hireDate_age40
  FROM employees
 WHERE (strftime('%Y', HireDate) - strftime('%Y', BirthDate) ) >= 40;

6. Покажите покупателей-амерканцев без факса ?

SELECT *
  FROM customers
 WHERE Country = 'USA' and Fax IS NULL;

7. Покажите канадские города в которые сделаны продажи в августе и сентябре месяце?

SELECT distinct shipCity as Citys_sales_month8and9
  FROM sales
WHERE ShipCountry = 'Canada' and (strftime('%m', SalesDate) = '08' or strftime('%m', SalesDate) = '09') или strftime('%m', SalesDate) in ('08', '09');

8. Покажите  почтовые адреса клиентов из домена gmail.com ?

SELECT 
       Address as address_gmail
       
  FROM customers
  WHERE Email like '%@gmail.com'

9. Покажите сотрудников  которые работают в кампании уже 18 лет и более ?
Варинт 1
SELECT *
  FROM employees
 WHERE	(strftime('%Y', date() ) - strftime('%Y', HireDate) ) >= 18 AND 
       	(strftime('%m', date() ) >= strftime('%m', HireDate) ) AND 
       	(strftime('%d', date() ) >= strftime('%d', HireDate) );

Вариант 2
SELECT LastName, FirsName, Email, Date('now') - HireDate
  FROM employees
 WHERE	(Date('now') - HireDate) >= 18

10.Покажите  в алфавитном порядке все должности в кампании  ?

SELECT 
       distinct Title
       
  FROM employees
  ORDER BY Title

11. Покажите  в алфавитном порядке Фамилию, Имя и год рождения покупателей  ?

SELECT FirstName,
       LastName,
       strftime('%Y', date()) - Age as birth_year
  FROM customers
 ORDER BY FirstName, LastName

12. Сколько секунд длится самая короткая песня ?

SELECT 
       MIN(Milliseconds)/1000
       
  FROM tracks;

13. Покажите название и длительность в секундах самой короткой песни

SELECT
       Name,
       MIN(Milliseconds)/1000
  FROM tracks
GROUP BY Name
ORDER BY  MIN(Milliseconds) limit 1;

14. Покажите средний возраст клиента для каждой страны ?
Вариант 1
SELECT 
       Country,
       sum(Age) / count(Country)
  FROM customers
  Group BY Country

Вариант 2
SELECT 
       Country,
       avg(Age)
  FROM customers
  Group BY Country

15. Покафите Фамилии работников нанятых в октябре?

SELECT *
  FROM employees
  Where strftime('%m', HireDate) = '10'

16. Покажите фамилию самого старого сотрудника
Вариант 1
SELECT LastName, MIN(strftime('%Y', BirthDate))
  FROM employees

Вариант 2
	SELECT LastName
  	FROM employees
	ORDER BY HireDate limit 1
17. Посчитайте общую сумму продаж в америку  в 1 квартале 2012 года? Решить 2-мя  способами Джойнами и Подзапросами 

Джойнами
SELECT sum(UnitPrice * Quantity) FROM sales s
INNER JOIN sales_items si ON s.SalesId = si.Sales.Id
WHERE ShipCountry = 'USA' AND
	SalesDate >= date('2012-01-01') AND
	SalesDate < date('2012-04-01')

Подзапросами
SELECT sum(
		(
			SELECT sum(UnitPrce * Quantity)
			FROM sales_items si
			WHERE s.SalesId = si.SalesId
		)
	   ) as summ
FROM sales s
WHERE ShipCountry = 'USA' AND
	SalesDate >= date('2012-01-01') AND
	SalesDate < date('2012-04-01')


